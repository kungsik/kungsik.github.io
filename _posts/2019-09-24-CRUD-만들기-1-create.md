---
title: CRUD 만들기 (1) - Create
date: 2019-09-24 11:00:08
categories:
- web-programming
comments: true
tags: CRUD, web-design
---

흔히 웹 프로그래밍에 있어서 기본이 되는 개념이 CRUD라고 합니다. CRUD란 Create(생성), Read(읽기), Update(갱신), Delete(삭제)의 앞 글자를 딴 말입니다. 즉, 사용자가 어떤 서비스를 사용할 때 기본적으로 서비스가 갖춰야할 기능을 의미합니다. 

이는 여러분들이 흔히 사용하는 게시판을 떠올리시면 됩니다. 내가 어떤 새로운 게시물을 올리는 것은 "생성"의 단계입니다. 그리고 내가 올린 글을 누군가가 읽을 수 있어야겠죠. 이 단계가 바로 "읽기"입니다. 그런데 내가 올린 글에 오타가 있어서 수정을 해야 하는데, 이 단계가 바로 "갱신"입니다. 그리고 내가 쓴 글이 마음에 들지 않는다면 "삭제"를 해야겠지요.

이 개념은 비단 게시물 뿐만 아니라 웹서비스에서 데이터를 다루는 모든 영역에 적용됩니다. 회원가입(생성) 후에 나의 가입 정보를 볼 수 있어야 하고(읽기), 이메일 주소와 같은 정보를 수정해야 하며(갱신), 탈퇴할 수 있어야 합니다(삭제). 

이런 플로우들이 원활히 이루어져야 사용자들이 불편을 겪지 않을 수 있습니다. 예를 들어 글을 올렸는데 수정버튼이 없다면 상당히 난감할 것입니다. 본 포스트에서는 개발자들이 프로젝트를 할 때, 어떤 단계에서 어떤 절차로 CRUD를 만들어 가는 것이 좋은지 제 개인적인 경험에 비추어 나눠 보도록 하려고 합니다.


### CREATE (생성) - DB 디자인


제 경험에 비추어 생각해 보면 CRUD라는 말 자체가 개발 절차와 동일한 것 같습니다. 즉, 데이터 입출력 기능을 구현할 때 생성 -> 읽기 -> 갱신(수정) -> 삭제 등의 순서로 개별하는 것이 효율적이라는 것입니다. 왜냐하면 기능 테스트를 할 때 데이터 생성 기능 없이 다른 기능들을 구현하는 것은 불가능하기 때문입니다. 

일단 "생성"의 단계를 구현하는 것은 기본적인 데이터베이스 구조를 디자인하는 것으로부터 시작합니다. 데이터베이스의 종류(sql, nosql?)를 선택하는 것에서부터 어떤 테이블을 만들고 컬럼은 어떻게 짜야 하고 등등을 구상해야 합니다. 요즘은 mongodb와 같은 nosql과 같은 데이터베이스 엔진은 컬럼의 추가나 변경이 매우 유동적이지만, sql 계열의 데이터베이스들은 한번 디자인이 정해지면 나중에 수정이나 업데이트가 다소 어렵기 때문에 원활한 DB 디자인이 중요합니다.


1. 고유한 키 값

일단 DB 디자인에 있어 중요한 것은 각 데이터의 고유한 id 값입니다. 데이터가 중복되는 일이 없도록 키값이라고도 불리는 고유값을 지정해 주어야 하는데 이를 순차적으로 올라가는 번호가 될지, 이메일로 할지 등을 결정해야 합니다. 일반적으로는 mysql의 auto_increment 옵션을 통해 자동적으로 올라가는 숫자 값을 키값으로 많이 사용합니다. 이러한 키값은 데이터가 쌓인 순서와 동일하기 때문에 데이터를 순차적으로 배열할 때에도 편리하게 사용할 수 있습니다. 


2. 데이터 유형

DB를 디자인할 때 중요한 것이 데이터의 유형(Type)을 지정해 주는 것입니다. 이는 데이터가 많지 않을 때에는 그리 큰 영향은 없지만 데이터가 많이 쌓일 수록 디비 성능에 큰 영향을 줄 수 있습니다. 데이터의 유형은 다양하지만 대표적으로 정수(int)나 문자(varchar, text) 유형이 있습니다. 이러한 유형은 각 데이터가 숫자값인지 문자인지 등을 판단해서 그에 맞는 유형을 선택해 주어야 합니다. 그리고 이 유형을 정의할 때 추가적으로 각 유형의 자료가 들어갈 공간의 크기도 정의를 해 주게 되는데, 이 때에는 적절한 용량을 분배해 주어야 합니다. 예를 들어 게시물의 제목 데이터가 들어가는 란에 text 값을 주어 불필요하게 큰 용량을 차지하게 하는 것보다는 varchar(100)과 같이 100자 정도의 용량만 지정해 주는 것이 보다 효율적인 용량 배분이 될 것입니다.


3. NULL 값 설정

DB의 데이터 설정에는 Null 값, 즉 빈값을 허용할 것인지 아닌지에 관한 설정을 할 수 있습니다. 예를 들면 회원 가입시 아이디가 필수 입력 사항이라면 아이디의 빈값을 허용하지 않게 됩니다. 이 경우 오류를 반환하겠지요. 그러나 사용자 편의성을 위해 디비 실행을 하기 전 자바스크립트나 jquery를 이용해서 아이디 입력난에 값이 들어오지 않을 경우 오류창을 띄어 주는 것이 좋습니다. 왜냐하면 열심히 긴글을 작성했는데 실수로 제목을 입력하지 않고, 화면을 그대로 갱신했을 경우 디비 오류가 나고, 다시 쓰기 화면으로 돌아왔을 때 자료가 다 없어질 수 있기 때문입니다. 

물론 자바스크립트를 통한 블럭은 한계가 있기 때문에, 악의적인 사용자가 url이나 post 값 변조를 통해 자바스크립트를 우회할 수도 있기 때문에 디비 단에서도 안전장치를 해 놓는 것이 좋습니다.


4. 중간 저장과 같은 사용자 편의성

이는 위에서 언급해 드린 것과 유사한 맥락입니다. 워드 프레스에는 사용자가 포스트를 작성할 때, 일정 시간이 지나면 게시물을 자동으로 저장하는 기능이 있습니다. 이 기능은 사용자가 링크를 잘못 클릭하여 다른 화면으로 전환되었을 때 작성하던 글이 다 날라가는 불상사를 방지할 수 있습니다. 

만약 이 기능을 구현한다고 할 때에 여러 선택지가 있습니다. 중간 데이터를 어떻게 저장하느냐입니다. 서버의 용량이 괜찮다고 한다면 서버 db에 저장할 수도 있습니다. 그러나 서버에 무리가 가게 하고 싶지 않으면 사용자의 컴퓨터에 그 부담을 갖게할 수도 있는데, 이는 사용자 브라우저의 쿠키 혹은 Local Storage에 저장시키는 방법입니다. 어떤 유형을 선택하느냐에 따라 그 용량과 방식이 달라지므로 잘 선택해야겠습니다. 그리고 유럽연합의 법은 사이트가 사용자의 쿠키를 사용할 경우 이에 대한 공지를 의무해야 하므로 이 또한 고려 사항이 됩니다.



CRUD는 결국 사용자 경험을 최적화하기 위한 개념임을 잊지 말아야 합니다. 개발자는 A부터 Z까지 사용자의 불편함을 예상해서 서비스를 생각해야 하는 것입니다. 다음 포스트에서는 READ 단계에 대해 나눠보겠습니다.


